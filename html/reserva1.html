<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reserva de Paquete Turístico</title>
  <link rel="stylesheet" href="../css/reserva1.css" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded" rel="stylesheet" />
</head>

<body>
  <header>
    <div class="brand">
      <img src="../assets/logo-chimbote.jpg" alt="Logo Agencia" class="logo" />
      <h1>Chimbote Travel Tours</h1>
    </div>
    <nav class="menu">
      <ul>
        <li><a href="chimbotes.html">Inicio</a></li>
        <li><a href="destinos.html">Destinos</a></li>
        <li><a href="reserva1.html" class="active">Reserva</a></li>
        <!-- <li><a href="#contacto">Contacto</a></li> -->
        <li><a href="login.html" class="btn-register-nav">Iniciar Sesión</a></li>
      </ul>
    </nav>
  </header>
  <section id="reserva">
    <div class="contenedor">
      <h2>Formulario de Reserva</h2>
      <form action="reserva2.html" method="get">
        <div class="campo">
          <label for="cliente">Nombre:</label>
          <input type="text" id="cliente" name="cliente" required />
        </div>
        <div class="campo">
          <label for="correo">Correo electrónico:</label>
          <input type="email" id="correo" name="correo" required />
        </div>
        <div class="campo">
          <label for="destinos">Destino:</label>
          <select id="destinos" name="destinos" required>
            <option value="">Seleccione</option>
            <option value="Machu Picchu">Machu Picchu – Cusco</option>
            <option value="Montaña">Montaña de 7 Colores – Cusco</option>
            <option value="Valle Sagrado">Valle Sagrado + Pisac – Cusco</option>
            <option value="Paracas">Paracas + Huacachina – Ica</option>
            <option value="Máncora">Máncora + Nado con Tortugas – Piura</option>
            <option value="Cañon">Cañón del Colca – Arequipa</option>
            <option value="Arequipa">Arequipa Colonial + Santa Catalina</option>
            <option value="Laguna">Laguna Humantay – Cusco</option>
            <option value="Tarapoto">Tarapoto + Cataratas de Ahuashiyacu</option>
            <option value="Iquitos">Iquitos + Selva Amazónica</option>
            <option value="Ayacucho">Ayacucho + Aguas Turquesas de Millpu</option>
            <option value="Cajamarca">Cajamarca Histórica + Baños del Inca</option>
          </select>
        </div>
        <div class="campo">
          <label for="fecha">Fecha de Viaje:</label>
          <input type="date" id="fecha" name="fecha" required />
        </div>
        <div class="campo">
          <label for="personas">Cantidad de Personas:</label>
          <input type="number" id="personas" name="personas" min="1" required />
        </div>
        <button type="submit" class="btn-reservar">Reservar</button>
      </form>
    </div>
  </section>

  <section id="footer-main" class="footer-info">
    <div class="info-contenedor">
      <div>
        <h3>Sobre Nosotros</h3>
        <p>Somos una empresa chimbotana comprometida con promover el turismo y la cultura del Perú, brindando
          experiencias únicas para quienes desean descubrir la diversidad y el encanto de nuestro país.</p>
      </div>

      <div class="Horario">
        <h3>Horario</h3>
        <p><span class="material-symbols-rounded">schedule</span> Lunes a Viernes: 9:00 am - 6:00 pm</p>
        <p><span class="material-symbols-rounded">event</span> Sábado: 9:00 am - 1:00 pm</p>
        <p><span class="material-symbols-rounded">event_busy</span> Domingo: Cerrado</p>
      </div>

      <div class="Pago">
        <h3>Métodos de Pago</h3>
        <div class="pagos">
          <a href="#"><img src="https://upload.wikimedia.org/wikipedia/commons/5/5e/Visa_Inc._logo.svg" alt="Visa"></a>
          <a href="#"><img src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Mastercard-logo.svg"
              alt="Mastercard"></a>
          <a href="#"><img
              src="https://upload.wikimedia.org/wikipedia/commons/0/08/Icono_de_la_aplicaci%C3%B3n_Yape.png"
              alt="Yape"></a>
          <a href="#"><img
              src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTo9ig-yw4ZC6cj896X8Fl3DSd160deJD-dFw&s"
              alt="Plin"></a>
        </div>
      </div>
    </div>

    <div class="footer-social-icons">
      <a href="https://www.facebook.com/ChimboteTravelToursEirl/about?locale=es_LA"><img
          src="https://upload.wikimedia.org/wikipedia/commons/thumb/c/cd/Facebook_logo_%28square%29.png/960px-Facebook_logo_%28square%29.png"
          alt="Facebook" width="30"></a>
      <a href="https://www.instagram.com"><img
          src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Instagram_logo_2016.svg" alt="Instagram"
          width="30"></a>
      <a href="https://www.tiktok.com"><img
          src="https://img.freepik.com/vector-premium/logotipo-redes-sociales-vector-tiktok_1093524-451.jpg"
          alt="TikTok" width="30"></a>
      <a href="https://wa.me/51942620099"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png"
          alt="WhatsApp" width="30"></a>
    </div>
  </section>

  <footer>
    © 2025 Portal Turístico de Chimbote | Todos los derechos reservados.
  </footer>

  <a href="https://wa.me/51942620099" class="btn-whatsapp" target="_blank">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSoCBicT8UV0JC5EYe3Scy1Um_5RWsSxDKY_w&s"
      alt="WhatsApp">
  </a>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.querySelector('form');

      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        const submitBtn = form.querySelector('button[type="submit"]');
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.textContent = 'Procesando...';

        // Obtener datos del formulario
        const destinosSelect = document.getElementById('destinos');
        const selectedOption = destinosSelect.options[destinosSelect.selectedIndex];

        // Usar el texto de la opción como nombre del destino (ej: "Machu Picchu – Cusco")
        // O el valor si prefieres. El usuario tiene valores como "Machu Picchu".
        const destinationName = selectedOption.text;

        const formData = {
          client_name: document.getElementById('cliente').value,
          client_email: document.getElementById('correo').value,
          destination_name: destinationName, // Enviamos el nombre, la API lo resolverá
          travel_date: document.getElementById('fecha').value,
          number_of_people: document.getElementById('personas').value
        };

        try {
          // Usamos la URL completa porque estás abriendo el HTML desde otro puerto (ej. 5500)
          const response = await fetch('http://localhost:3000/api/reservations', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(formData)
          });

          const result = await response.json();

          if (response.ok && result.success) {
            // Redirigir a la página de éxito original
            window.location.href = 'reserva2.html';
          } else {
            alert('Error al realizar la reserva: ' + (result.message || result.error));
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
          }
        } catch (error) {
          console.error('Error:', error);
          alert('Error de conexión al servidor');
          submitBtn.disabled = false;
          submitBtn.textContent = originalText;
        }
      });
    });
  </script>
</body>

</html>