## ConfiguraciÃ³n de Oracle Database para Chimbote Travel API
## ğŸ”§ Requisitos Previos

1. Oracle Database 21c Express Edition (XE)

2. SQL Developer (opcional, recomendado)

3. Node.js 16+

4. npm

## InstalaciÃ³n de Oracle Database 21c XE

## 1. Descargar instalador:
https://www.oracle.com/database/technologies/xe-downloads.html

Instalar normalmente

Definir contraseÃ±a del usuario SYS

Oracle queda disponible en:

Host: localhost

Puerto: 1521

Servicio: XEPDB1

## 2. Crear Usuario del Proyecto

Conectarse como SYSDBA en SQL Developer:

CONNECT SYS AS SYSDBA;


Crear usuario, permisos y cuota:

CREATE USER chimbote_user IDENTIFIED BY marinita;
GRANT CONNECT, RESOURCE TO chimbote_user;
ALTER USER chimbote_user QUOTA UNLIMITED ON USERS;

## 3. Crear Tablas del MÃ³dulo Oracle

Conectarse como chimbote_user y ejecutar:

CREATE TABLE empleados (
  id_empleado NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombre VARCHAR2(100) NOT NULL,
  cargo VARCHAR2(100),
  salario NUMBER(10,2),
  fecha_ingreso DATE DEFAULT SYSDATE
);

CREATE TABLE finanzas (
  id_finanza NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  descripcion VARCHAR2(200),
  monto NUMBER(10,2),
  tipo VARCHAR2(30),
  fecha_registro DATE DEFAULT SYSDATE
);

## 4. Insertar Datos de Ejemplo
INSERT INTO empleados (nombre, cargo, salario)
VALUES ('Juan PÃ©rez', 'GuÃ­a turÃ­stico', 1800);

INSERT INTO empleados (nombre, cargo, salario)
VALUES ('Ana Torres', 'Recepcionista', 1500);

INSERT INTO finanzas (descripcion, monto, tipo)
VALUES ('Pago a proveedores', 2500, 'Egreso');

INSERT INTO finanzas (descripcion, monto, tipo)
VALUES ('Venta de paquete turÃ­stico', 1200, 'Ingreso');


Verificar tablas:

SELECT table_name FROM user_tables;
SELECT * FROM empleados;
SELECT * FROM finanzas;

## 5. Configurar Variables de Entorno (.env)
# ===========================================
# CONFIGURACIÃ“N DE ORACLE
# ===========================================
ORACLE_HOST=localhost
ORACLE_PORT=1521
ORACLE_SERVICE_NAME=XEPDB1
ORACLE_USER=chimbote_user
ORACLE_PASSWORD=marinita

## 6. Crear Archivo de ConexiÃ³n en Node.js

ğŸ“ Ruta: api/config/oracle.js

const oracledb = require("oracledb");
require("dotenv").config();

oracledb.outFormat = oracledb.OUT_FORMAT_OBJECT;

// FunciÃ³n que devuelve una conexiÃ³n lista para usar
async function getOracleConnection() {
  return await oracledb.getConnection({
    user: process.env.ORACLE_USER,
    password: process.env.ORACLE_PASSWORD,
    connectString: `${process.env.ORACLE_HOST}:${process.env.ORACLE_PORT}/${process.env.ORACLE_SERVICE_NAME}`
  });
}

module.exports = { getOracleConnection };

## 7. Crear Script de Prueba de ConexiÃ³n

ğŸ“ Archivo en la raÃ­z: oracle-test.js

const { getOracleConnection } = require("./api/config/oracle");

async function testOracle() {
  console.log("ğŸ”— PRUEBA DE CONEXIÃ“N A ORACLE\n");

  try {
    // 1. ConexiÃ³n a Oracle
    const conn = await getOracleConnection();
    console.log("âœ… ConexiÃ³n exitosa con Oracle\n");

    // 2. Consulta de prueba
    const r = await conn.execute(
      "SELECT 'Conectado a Oracle desde Node.js' AS MENSAJE FROM DUAL"
    );
    console.log("ğŸ“¢ Mensaje:", r.rows[0].MENSAJE);

    // 3. Leer tabla EMPLEADOS
    const empleados = await conn.execute("SELECT * FROM EMPLEADOS");
    console.log("\nğŸ“‹ Empleados:");
    console.table(empleados.rows);

    // 4. Cerrar conexiÃ³n
    await conn.close();
    console.log("\nğŸ”’ ConexiÃ³n cerrada correctamente.");

  } catch (error) {
    console.error("âŒ Error conectando a Oracle:");
    console.error(error);
  }
}

testOracle();


Ejecutar prueba:

node oracle-test.js

## 8. Resultado Esperado
ğŸ”— PRUEBA DE CONEXIÃ“N A ORACLE
âœ… ConexiÃ³n exitosa con Oracle

 Mensaje: Conectado a Oracle desde Node.js

 Empleados:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id_empleado â”‚ nombre â”‚ cargo â”‚ salario â”‚ fecha_ingreso â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

 ConexiÃ³n cerrada correctamente.

# 9. SoluciÃ³n de Problemas
âŒ ORA-01017

Credenciales incorrectas
âœ” Revisar usuario/contraseÃ±a en .env

âŒ ORA-12514 / ORA-12154

Servicio incorrecto
âœ” Confirmar servicio: XEPDB1

âŒ Error al instalar oracledb

Ejecutar en PowerShell ADMIN:

Set-ExecutionPolicy RemoteSigned
npm install oracledb



